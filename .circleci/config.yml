# version: 2.1
# orbs:
#   cypress: cypress-io/cypress@1.11.0
# workflows:
#   install:
#     branches:
#       only:
#         - master
#         - /release-.*/
#     jobs:
#       - cypress/run:
#         yarn: true

# jobs:
#   install:
#     branches:
#       only:
#         - master
#         - /release-.*/
#     docker:
#       - image: circleci/node:10.16.3
#     steps:
#       - checkout
#       - run: yarn
#       - run: yarn test:unit
#       - run: yarn test:e2e
version: 2.1
executors:
  my-executor:
    docker:
      - image: circleci/node:10.16.3
    working_directory: ~/erp
jobs:
  install:
    executor: my-executor
    steps:
      - checkout
      - attach_workspace:
          at: ~/erp
      - run: pwd
      - run: yarn
      - run: ls -a
      - persist_to_workspace:
          root: ~/erp
          paths:
            - ./node_modules
  test_unit:
    executor: my-executor
    steps:
      - checkout
      - attach_workspace:
          at: ~/erp
      - run: pwd
      - run: ls -a
      - run: yarn test:unit
workflows:
  version: 2.1
  install_and_test:
    jobs:
      - install
      - test_unit:
          requires:
            - install
